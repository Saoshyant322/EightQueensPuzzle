<!DOCTYPE html>
<html lang="en">
<head>
    <title>Maysam Razi - Eight Queens Puzzle</title>
    <meta charset="utf-8"/>
    <link rel="icon" href="img/icon.jpg">
    <script>

        var
            POS_Col = ["hpt_525", "hpt_450", "hpt_375", "hpt_300", "hpt_225", "hpt_150", "hpt_75", "hpt_0"],
            POS_Row = ["hpl_0", "hpl_75", "hpl_150", "hpl_225", "hpl_300", "hpl_375", "hpl_450", "hpl_525"],
            N = 8,
            queenActiveInBoard = 0,
            doesInitial = false,
            showCommandP = false;
        var q = {rowQ:-1,columnQ:-1},
            queens_8 =[q,q,q,q,q,q,q,q],
            epoch = 0;
        fullHomeIndex = [
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false],
            [false, false, false, false, false, false, false, false]
        ];

        function setupBoard() {

        }

        function fillAllPoint(showNumbersHome = false) {
            let htmlPoint = "", posL = "", posH = "", homeNumber = "";
            for (let i = 0; i < 8; i++) {
                let posCol = POS_Col[7 - i];
                for (let j = 0; j < 8; j++) {
                    let posRow = POS_Row[j];
                    homeNumber = (showNumbersHome) ? ((i * 8) + (j) + 1) : "";
                    htmlPoint = htmlPoint + '<a class="fullHome ' + posRow + ' ' + posCol + '">' + homeNumber + '</a>';
                }
            }
            document.getElementById('point').innerHTML = htmlPoint;
        }
        function clearState() {
            document.location.reload();
        }

        function randomInitialState() {
          for (i=0;i<8;i++)
              release(i);
                for (let i = 0; i < 8; i++)
                    fillSquare(Math.floor(Math.random() * 8), i,i);
        }
        // ************** Solve function ****************
        function checkClashQueens() {

            let valueState = 0, isClashed=true;
            switch (queenActiveInBoard) {
              case 0:

                break;
            }
            return isClashed;
        }
        function gradeCalculate(){
            commandLine('Calculate grade');
          let valueState = 28;
          document.getElementById('showValuePosition').innerText = valueState.toString();
        }

        const  functionList = [solveRows,solveRowsWithAStart];
        function solvePuzzle() {
          commandLine('Start puzzle solver');
          for (i=0;i<8;i++)
              release(i);
          functionList[document.getElementById('algorithm').selectedIndex]();
        }
        function findIndex(colIndex,minRow){
          let minInxed=-1;
          for(i = minRow ; i<8;i++)
            {
              if(fullHomeIndex[i][colIndex] == false)
                {
                  minInxed = i;
                  break;
                }
            }
            return minInxed;
        }
        function solveRows(){
          loopFind(0,0,0,0,0,0,0,0);
        }
        function loopFind(...minRows){

          epoch = epoch+1;
          commandLine('epoch = '+ epoch.toString())
          let nextRow =minRows[0];
          let oldRow=0;
          fillSquare(nextRow,0,0);
          nextRow =findIndex(1,minRows[1]);
          if(nextRow !==-1)
          {fillSquare(nextRow,1,1);
            oldRow= nextRow;
            nextRow =findIndex(2,minRows[2]);
            if(nextRow !==-1)
            {fillSquare(nextRow,2,2);
              oldRow= nextRow;
              nextRow =findIndex(3,minRows[3]);
              if(nextRow !==-1)
              {fillSquare(nextRow,3,3);
                oldRow= nextRow;
                nextRow =findIndex(4,minRows[4]);
                if(nextRow !==-1)
                {fillSquare(nextRow,4,4);
                  oldRow= nextRow;
                  nextRow =findIndex(5,minRows[5]);
                  if(nextRow !==-1)
                  {fillSquare(nextRow,5,5);
                    oldRow= nextRow;
                    nextRow =findIndex(6,minRows[6]);
                    if(nextRow !==-1)
                    {fillSquare(nextRow,6,6);
                      oldRow= nextRow;
                      nextRow =findIndex(7,minRows[7]);
                      if(nextRow !==-1)
                        {fillSquare(nextRow,7,7);}
                      else {
                        commandLine('7 finished');
                      }
                    }
                  }
                  else {
                    commandLine('6 finished');

                    commandLine('nextRow = '+ nextRow.toString());
                    release(4);
                    nextRow =findIndex(4,oldRow);
                    loopFind(minRows[0],minRows[1],minRows[2],minRows[3],nextRow,0,0,0);
                  }
                }
                else {
                  commandLine('5 finished');
                }
              }
              else {
                commandLine('4 finished');
              }
            }
            else {
              commandLine('3 finished');
            }
          }
          else {
            commandLine('2 finished');
          }
        }

        function solveRowsWithAStart(){
          commandLine('Solve puzzle by row a*');

        }

// ************** fill and release home function ****************
        function fillSquare(indexRow, IndexCol,indexQueen) {
          commandLine('Fill square');
          queens_8[indexQueen].rowQ=indexRow ;queens_8[indexQueen].columnQ =IndexCol;
          queenActiveInBoard = queenActiveInBoard+1;
            for (i =0 ;i<8;i++)
              {
              fullHomeIndex[indexRow][i] = true;
              fullHomeIndex[i][IndexCol] = true;
              if(indexRow-i > -1 && IndexCol-i > -1)
                fullHomeIndex[indexRow-i][IndexCol-i] = true;
              if(indexRow+i < 8 && IndexCol+i < 8)
                fullHomeIndex[indexRow+i][IndexCol+i] = true;
              if(indexRow-i > -1 && IndexCol+i < 8)
                fullHomeIndex[indexRow-i][IndexCol+i] = true;
              if(indexRow+i < 8 && IndexCol-i > -1)
                fullHomeIndex[indexRow+i][IndexCol-i] = true;
              }

              showFillHomes(indexRow,IndexCol);
          }

        function release(indexQueen){
          document.getElementById('image-queen').innerHTML="";
          document.getElementById('point').innerHTML="";
          queenActiveInBoard = 0;
          queens_8[indexQueen].rowQ = -1; queens_8[indexQueen].columnQ=-1;

          for(i=0;i<8;i++)
            for(j=0;j<8;j++)
              fullHomeIndex[i][j]= false;

          for(k=0;k<8;k++)
            if(queens_8[k].rowQ !=-1)
              {
                queenActiveInBoard = queenActiveInBoard+1;
                fillSquare(queens_8[k].rowQ,queens_8[k].columnQ,k);
              }
        }

        function showFillHomes(indexRow, IndexCol){
          let posCol = POS_Col[indexRow];
          let posRow = POS_Row[IndexCol];
          let htmlImg = document.getElementById('image-queen').innerHTML + '<img src="img/Whith_chess_queen_clip_art_20443.png" class="imgQueen ' + posCol + ' ' + posRow + '">';
          document.getElementById('image-queen').innerHTML = htmlImg;
          if (document.getElementById('red-pointer').checked == true) {

              let htmlPoint = "", posR = "", posC = "";
              for (i = 0 ; i<8 ;i++)
               for(j=0;j<8;j++)
               {
                 posR = POS_Row[j];
                 posC = POS_Col[i];
                 if(fullHomeIndex[i][j])
                    htmlPoint = htmlPoint + '<a class="fullHome ' + posR + ' ' + posC + '"></a>';
               }
              document.getElementById('point').innerHTML = htmlPoint;
        }
}
        // ************** Debug System trace  ****************
        function commandLine(newLine) {
            let textOld = document.getElementById('lineCommand').innerHTML;
            document.getElementById('lineCommand').innerHTML = textOld + "<a>> "+newLine+"</a><br>";
        }

        function showCommandPanel() {
            if (showCommandP) {
              commandLine('Hide command');
                document.getElementsByClassName('info-line')[0].style.visibility = 'hidden';
                document.getElementById('b-show').innerText = "Show Command Help";
                showCommandP = false;
            } else {
              commandLine('Show command');
                document.getElementsByClassName('info-line')[0].style.visibility = 'visible';
                document.getElementById('b-show').innerText = "Hide Command Help";
                showCommandP = true;
            }
        }

        function showState(){
          for(i = 0;i<8;i++)
            for(j = 0;j<8;j++)
              commandLine( '['+i.toString()+']['+j.toString()+'] = '+fullHomeIndex[i][j].toString());
        }
    </script>

    <style>
        @font-face {
            font-family: "SphereFez";
            src: url("fonts/SphereFez-Yz5g4.otf");
        }

        @font-face {
            font-family: "Moonglade";
            src: url("fonts/MoongladeDemoBold-jOzM.ttf");
        }

        @font-face {
            font-family: "Consolas";
            src: url("fonts/Consolas.ttf");
        }

        body {
            background-color: #dddddd;
            margin: 0;
            padding: 0;
        }

        .header {
            font-family: 'SphereFez';
            position: fixed;
            height: 70px;
            width: 100%;
            text-align: center;
            margin: 0;
            top: 0;
            background-color: rgba(168, 74, 92, 1);
            color: rgba(245, 213, 188, 1);
        }

        .boardPanel {
            top: 82px;
            position: absolute;
            width: 600px;
            height: 600px;
            background-color: rgba(39, 66, 87, 1);
            left: 12px;
        }

        .boardPanelW {
            position: absolute;
            width: 75px;
            height: 75px;
            background-color: rgba(223, 193, 131, 1);
        }

        .button-style-rp {
            width: 220px;
            height: 40px;
            background-color: rgba(223, 193, 131, 1);
            border: none;
            font-family: 'Moonglade';
            border-radius: 5px;
            font-size: 16px;
            margin-top: 20px;
            cursor: pointer;

        }

        .button-style-rp:hover {
            background-color: rgba(168, 74, 92, 1);
            color: white;
        }

        .rightPanel {
            background-color: #274257;
            position: absolute;
            width: 250px;
            height: 560px;
            top: 80px;
            right: 10px;
            border-radius: 5px;
            color: white;
            text-align: center;
        }

        .imgQueen {
            position: absolute;
            width: 75px;
            box-sizing: border-box;
            padding: 11px;
        }

        .fullHome {
            margin-left: 27.5px;
            margin-top: 27.5px;
            background-color: #ed0d38;
            position: absolute;
            width: 20px;
            height: 20px;
            opacity: 80%;
            z-index: 3;
            border-radius: 10px;
        }

        #showValuePosition {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 35px;
            text-align: center;
            box-sizing: border-box;
            padding-top: 10px;
            font-family: 'SphereFez';
            top: 83px;
            left: 623px;
            background: cadetblue;
            color: darkblue;
        }

        .info-line {
            visibility: hidden;
            position: fixed;
            width: 80%;
            height: 100px;
            box-sizing: border-box;
            border-radius: 8px;
            background-color: #aaaaaa;
            bottom: 10px;
            left: 10px;
            padding-top: 10px;
            padding-left: 10px;
            font-family: 'Consolas';
            overflow: auto;
        }
        .checkBox-size{
          width: 17px;
          height: 17px;
        }
        .checkBox-text{
          font-family: 'Moonglade';
        }
        /***************** vertical **********************/

        .hpt_0 {
            top: 0;
        }

        .hpt_75 {
            top: 75px;
        }

        .hpt_150 {
            top: 150px;
        }

        .hpt_225 {
            top: 225px;
        }

        .hpt_300 {
            top: 300px;
        }

        .hpt_375 {
            top: 375px;
        }

        .hpt_450 {
            top: 450px;
        }

        .hpt_525 {
            top: 525px;
        }

        /***************** Horizontal **********************/

        .hpl_0 {
            left: 0;

        }

        .hpl_75 {
            left: 75px;

        }

        .hpl_150 {
            left: 150px;

        }

        .hpl_225 {
            left: 225px;

        }

        .hpl_375 {
            left: 375px;
        }

        .hpl_525 {
            left: 525px;

        }

        .hpl_300 {
            left: 300px;

        }

        .hpl_450 {
            left: 450px;
        }
    </style>
</head>
<body onload="setupBoard();">
<div class="header">
    <h2>Maysam Razi : 8 queens puzzle - artificial intelligence</h2>
</div>
<div id="showValuePosition">0</div>
<div class="boardPanel">
    <div id="board">
        <div class="boardPanelW hpt_0 hpl_0"></div>
        <div class="boardPanelW hpt_0 hpl_150"></div>
        <div class="boardPanelW hpt_0 hpl_300"></div>
        <div class="boardPanelW hpt_0 hpl_450"></div>

        <div class="boardPanelW hpt_75 hpl_75"></div>
        <div class="boardPanelW hpt_75 hpl_225"></div>
        <div class="boardPanelW hpt_75 hpl_375"></div>
        <div class="boardPanelW hpt_75 hpl_525"></div>

        <div class="boardPanelW hpt_150 hpl_0"></div>
        <div class="boardPanelW hpt_150 hpl_150"></div>
        <div class="boardPanelW hpt_150 hpl_300"></div>
        <div class="boardPanelW hpt_150 hpl_450"></div>

        <div class="boardPanelW hpt_225 hpl_75"></div>
        <div class="boardPanelW hpt_225 hpl_225"></div>
        <div class="boardPanelW hpt_225 hpl_375"></div>
        <div class="boardPanelW hpt_225 hpl_525"></div>

        <div class="boardPanelW hpt_300 hpl_0"></div>
        <div class="boardPanelW hpt_300 hpl_150"></div>
        <div class="boardPanelW hpt_300 hpl_300"></div>
        <div class="boardPanelW hpt_300 hpl_450"></div>

        <div class="boardPanelW hpt_375 hpl_75"></div>
        <div class="boardPanelW hpt_375 hpl_225"></div>
        <div class="boardPanelW hpt_375 hpl_375"></div>
        <div class="boardPanelW hpt_375 hpl_525"></div>

        <div class="boardPanelW hpt_450 hpl_0"></div>
        <div class="boardPanelW hpt_450 hpl_150"></div>
        <div class="boardPanelW hpt_450 hpl_300"></div>
        <div class="boardPanelW hpt_450 hpl_450"></div>

        <div class="boardPanelW hpt_525 hpl_75"></div>
        <div class="boardPanelW hpt_525 hpl_225"></div>
        <div class="boardPanelW hpt_525 hpl_375"></div>
        <div class="boardPanelW hpt_525 hpl_525"></div>
    </div>

    <div id="image-queen">
    </div>
    <div id="point">
    </div>
</div>

<div class="rightPanel">
    <select id="algorithm" class="button-style-rp">
        <option>local beam search</option>
        <option>DFS</option>
        <option>A* search</option>
        <option>local beam search with row check</option>
        <option>local beam search with state check</option>
    </select>
    <button class="button-style-rp" onclick="randomInitialState()">Random State</button>
    <button class="button-style-rp" onclick="solvePuzzle()">Solve</button>
    <button id="b-show" class="button-style-rp" onclick="showCommandPanel()">Show Command Help</button>
    <button class="button-style-rp" onclick="showState()">Show State</button>
    <button class="button-style-rp" onclick="clearState()">Reset</button>
    <br><br><input type="checkbox" id="red-pointer" name="redPointer" class="checkBox-size" checked="checked">
    <label for="red-pointer" class="checkBox-text">Does show point?</label><br>

</div>
<div id="lineCommand" class="info-line"></div>
</body>

</html>
